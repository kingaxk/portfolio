function getHtml() {
  return `
    <!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <meta charset="UTF-8">
    <title>Zg≈Çoszenie nowego zatrudnienia</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;600&display=swap">
    <style>
      body {
        font-family: 'Segoe UI', sans-serif;
        background-color: #f0f8ff;
        color: #333;
        padding: 40px;
        margin: 0;
      }

      h2 {
        color: #1e6d91;
        margin-bottom: 20px;
      }

      section {
        margin-bottom: 30px;
        background-color: #ffffff;
        padding: 20px 30px;
        border-radius: 10px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        border-left: 6px solid #1e6d91;
      }

      section h3 {
        color: #1e6d91;
        margin-bottom: 15px;
        font-size: 18px;
      }

      form {
        display: flex;
        flex-direction: column;
        gap: 30px;
      }

      label {
        display: block;
        margin-top: 5px;
        font-weight: 500;
      }

      select:required:invalid, input[type="date"]:invalid {
        color: gray;
      }

      input, select, textarea {
        width: 100%;
        max-width: 600px;
        padding: 10px;
        margin-top: 5px;
        font-size: 14px;
        border: 1px solid #ccc;
        border-radius: 8px;
        background-color: #f9fcff;
      }

      textarea {
        resize: vertical;
        min-height: 80px;
      }

      button {
        background-color: #1e6d91;
        color: white;
        border: none;
        padding: 12px 24px;
        font-size: 16px;
        border-radius: 8px;
        cursor: pointer;
        transition: background-color 0.2s ease;
        width: fit-content;
      }

      button:hover {
        background-color: #155773;
      }

      #msg {
        margin-top: 20px;
        font-weight: bold;
        color: #1e6d91;
      }

      .optional {
        font-weight: normal;
        font-size: 13px;
        color: #777;
      }

      .adres-blok {
        margin-left: 20px;
        margin-bottom: 10px;
      }

      .adres-domowy-blok {
        margin-left: 30px;
        margin-bottom: 10px;
      }

      .adres-domowy-blok label {
        font-weight: normal;
        display: block;
        margin-bottom: 10px;
      }

      .adres-blok label {
        font-weight: normal;
        display: block;
        margin-bottom: 10px;
      }

      .wsuniecie {
        margin-left: 20px;
      }

      .podsekcja {
        margin-left: 20px;
        margin-top: 10px;
        margin-bottom: 20px;
      }

      .podsekcja-label {
        display: block;
        font-weight: bold;
        margin-bottom: 8px;
        font-size: 15px;
        color: #1e6d91;
      }

      .summary-item {
        margin-bottom: 14px;
        line-height: 1.6;
      }

      .summary-label {
        font-weight: bold;
        display: inline-block;
        min-width: 150px;
        color: #1e6d91;
      }

      .summary-value {
        display: inline-block;
      }

      .summary-section {
        margin-top: 25px;
        margin-bottom: 10px;
        font-weight: bold;
        color: #444;
        font-size: 16px;
        border-bottom: 1px solid #eee;
        padding-bottom: 4px;
      }

      @media screen and (max-width: 600px) {
        .summary-label {
         min-width: 120px;
         display: block;
          margin-bottom: 5px;
       }
        .summary-item {
      display: block;
      }
}

#summaryModal {
  padding: 20px;
}


    </style>
  </head>
  <body>
    <h2>Zg≈Çoszenie nowego zatrudnienia</h2>
    <form id="hireForm">
      <section>
  <h3>üßù Dane pracownika</h3>
  <label>Imiƒô i nazwisko*:
    <input name="imieNazwisko" required>
  </label>
  <label>PESEL*:
    <input name="pesel" id="pesel" required maxlength="11" placeholder="np. 12345678901">
  </label>
  <label>Adres zamieszkania</label>
  <div class="adres-blok">
    <label>Ulica*:
      <input name="adres_ulica" required>
    </label>
    <label>Nr domu / mieszkania*:
      <input name="adres_nr" required>
    </label>
    <label>Kod pocztowy*:
      <input name="adres_kod" id="kodPocztowy" required placeholder="00-000" maxlength="6">
    </label>
    <label>Miasto*:
      <input name="adres_miasto" required>
    </label>
  </div>
  <label>Nr telefonu*:
    <input name="telefon" id="telefon" required placeholder="123 456 789" maxlength="11">
  </label>
</section>

<section>
  <h3>üìÅ Szczeg√≥≈Çy wsp√≥≈Çpracy</h3>
  <div class="podsekcja">
    <label>Stanowisko*:
      <input name="stanowisko" required>
    </label>
    <label>Dzia≈Ç / Pion*:
      <select name="dzial" required onchange="toggleInne('dzial', 'dzial_inne')">
        <option value="" disabled selected hidden>Wybierz</option>
        <option>Support</option>
        <option>IT</option>
        <option>Team Nauczycielski</option>
        <option>Inne</option>
      </select>
    </label>
    <div id="dzial_inne" class="wsuniecie" style="display:none;">
      <label>Wpisz inny dzia≈Ç:
        <input name="dzial_inne_input">
      </label>
    </div>
    <label>Zakres obowiƒÖzk√≥w: <span class="optional">(opcjonalne)</span>
      <textarea name="zakres"></textarea>
    </label>
  </div>

  <div class="podsekcja">
    <label>Sp√≥≈Çka zatrudniajƒÖca*:
      <select name="spolka" required>
        <option value="" disabled selected hidden>Wybierz</option>
        <option>Szko≈Ça w Chmurze</option>
        <option>Fundacja</option>
      </select>
    </label>
    <label>Data podpisania umowy*:
      <input type="date" name="dataZatrudnienia" required>
    </label>
    <label>Rodzaj umowy*:
      <select name="rodzajUmowy" required onchange="toggleCzasTrwania(this.value)">
        <option value="" disabled selected hidden>Wybierz</option>
        <option>Umowa na okres pr√≥bny</option>
        <option>Umowa na czas okre≈õlony</option>
        <option>Umowa na czas nieokre≈õlony</option>
      </select>
    </label>
    <label>Forma wsp√≥≈Çpracy*:
      <select name="forma" required onchange="toggleCzasPracy(this.value); toggleInne('forma', 'forma_inna')">
        <option value="" disabled selected hidden>Wybierz</option>
        <option>Umowa o pracƒô</option>
        <option>Umowa B2B</option>
        <option>Umowa zlecenie</option>
        <option>Inne</option>
      </select>
    </label>
    <div id="forma_inna" class="wsuniecie" style="display:none;">
      <label>Opisz innƒÖ formƒô wsp√≥≈Çpracy:
        <input name="inna_forma_wspolpracy">
      </label>
    </div>
  </div>

  <div id="czasTrwania">
    <label>Data rozpoczƒôcia wsp√≥≈Çpracy*:
      <input type="date" name="od" required>
    </label>
    <div id="czasDoContainer">
      <label>Umowna data zako≈Ñczenia wsp√≥≈Çpracy*:
        <input type="date" name="do" required>
      </label>
    </div>
  </div>

  <div id="czasPracyContainer"></div>

  <label>Premie / bonusy / inne: <span class="optional">(opcjonalne)</span>
    <input name="premie">
  </label>
</section>

<section>
  <h3>üè¢ Organizacja pracy</h3>
  <label>Model miejsca pracy*:
    <select name="model" required onchange="toggleMiejscePracy(this.value)">
      <option value="" disabled selected hidden>Wybierz</option>
      <option>Stacjonarny</option>
      <option>Zdalny</option>
      <option>Hybrydowy</option>
    </select>
  </label>
  <div id="miejscePracy"></div>
  <label>Prze≈Ço≈ºony*:
    <input name="przelozony" required>
  </label>
  <label>Opiekun wdro≈ºeniowy: <span class="optional">(opcjonalne)</span>
    <input name="opiekun">
  </label>
  <label>Inne uwagi: <span class="optional">(opcjonalne)</span>
    <textarea name="uwagi"></textarea>
  </label>
</section>

<button type="button" onclick="showSummary()">Zapisz</button>

    </form>
    <div id="msg"></div>

<div id="summaryModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background-color:rgba(0,0,0,0.4); z-index:999; overflow-y: auto;">
  <div style="background:white; max-width:600px; margin:40px auto; padding:30px; border-radius:10px; display:flex; flex-direction:column; gap:20px;">
    <h3>üìã Podsumowanie zg≈Çoszenia</h3>
    <div id="summaryContent" style="flex: 1;"></div>
    <div style="display:flex; justify-content:flex-end; gap:10px; padding-top: 10px; border-top: 1px solid #ddd;">
      <button onclick="confirmSubmission()">üìÑ Zapisz i pobierz PDF</button>
      <button onclick="closeSummary()">‚úñÔ∏è Wr√≥ƒá do edycji</button>
    </div>
  </div>
</div>


<div id="successModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background-color:rgba(0,0,0,0.5); z-index:1000; overflow-y:auto;">
  <div style="background:white; max-width:600px; margin:60px auto; padding:30px; border-radius:10px; box-shadow:0 5px 20px rgba(0,0,0,0.2); display:flex; flex-direction:column; gap:20px;">
    <h3>‚úÖ Dokument zapisany</h3>
    <p style="font-size:16px;">Plik zosta≈Ç zapisany oraz pobrany automatycznie na Twoje urzƒÖdzenie.</p>
    <p style="font-size:16px;">üìé <a id="driveLink" href="#" target="_blank" style="color:#1e6d91; text-decoration:underline;">Otw√≥rz dokument na Dysku Google</a></p>
    <p style="font-size:15px;">‚úçÔ∏è <strong>Podpisz dokument i przeka≈º do dzia≈Çu Kadr.</strong></p>
    <div style="display:flex; justify-content:flex-end;">
      <button onclick="closeSuccessModal()">Zamknij</button>
    </div>
  </div>
</div>


    <script>
// === Obs≈Çuga dynamicznych p√≥l ===
function toggleInne(selectId, inputId) {
  const select = document.querySelector(`select[name="${selectId}"]`);
  const inne = document.getElementById(inputId);
  inne.style.display = select.value === "Inne" ? "block" : "none";
}

function toggleCzasTrwania(rodzaj) {
  const doContainer = document.getElementById("czasDoContainer");
  if (rodzaj === "Umowa na czas nieokre≈õlony") {
    doContainer.style.display = "none";
  } else if (document.querySelector('select[name="forma"]').value === "Inne") {
    doContainer.style.display = "block";
    doContainer.querySelector("input").removeAttribute("required");
  } else {
    doContainer.style.display = "block";
    doContainer.querySelector("input").setAttribute("required", "true");
  }
}

function toggleMiejscePracy(model) {
  const container = document.getElementById("miejscePracy");
  container.innerHTML = "";

  if (model === "Zdalny" || model === "Hybrydowy") {
    container.innerHTML += `
      <label class="wsuniecie">Adres domowy</label>
      <div class="adres-domowy-blok">
        <label>Ulica*:<input name="adres_domowy_ulica" required></label>
        <label>Nr domu / mieszkania*:<input name="adres_domowy_nr" required></label>
        <label>Kod pocztowy*:<input name="adres_domowy_kod" id="kodPocztowyDomowy" required maxlength="6"></label>
        <label>Miasto*:<input name="adres_domowy_miasto" required></label>
      </div>`;
  }

  if (model === "Stacjonarny" || model === "Hybrydowy") {
    container.innerHTML += `
      <div class="wsuniecie">
        <label>Biuro firmowe*:
          <select name="adres_biuro" required>
            <option value="" disabled selected hidden>Wybierz</option>
            <option>Biuro na PowƒÖzkowskiej</option>
            <option>Centrum Spotka≈Ñ lub Robotyki</option>
          </select>
        </label>
      </div>`;
  }
}

function toggleCzasPracy(forma) {
  const container = document.getElementById("czasPracyContainer");
  container.innerHTML = "";

  if (forma === "Umowa o pracƒô") {
    container.innerHTML = `
      <label>Czƒô≈õƒá etatu*:
        <select name="wymiar" required onchange="toggleInne('wymiar', 'etat_inny')">
          <option value="" disabled selected hidden>Wybierz</option>
          <option>1</option>
          <option>3/4</option>
          <option>1/2</option>
          <option>1/4</option>
          <option>Inne</option>
        </select>
      </label>
      <div id="etat_inny" required class="wsuniecie" style="display:none;">
        <label>Wpisz czƒô≈õƒá etatu:
          <input name="etat_inny_input">
        </label>
      </div>
      <label>Wynagrodzenie miesiƒôczne brutto (PLN)*:
        <input type="number" name="wynagrodzenie" required>
      </label>`;
  } else if (forma === "Umowa B2B" || forma === "Umowa zlecenie") {
    container.innerHTML = `
      <label>Rodzaj rozliczenia*:
        <select name="${forma === "Umowa B2B" ? "b2b_typ" : "zlecenie_typ"}" onchange="toggleRozliczenie('${forma}', this.value)">
          <option value="" disabled selected hidden>Wybierz</option>
          <option value="miesiƒôczne">Miesiƒôczne</option>
          <option value="godzinowe">Godzinowe</option>
          <option value="inne">Inne</option>
        </select>
      </label>
      <div id="rozliczenieContainer"></div>`;
    toggleRozliczenie(forma, "miesiƒôczne");
  } else if (forma === "Inne") {
    container.innerHTML = `
      <label>Opis warunk√≥w wsp√≥≈Çpracy:<textarea name="inne_warunki_wspolpracy"></textarea></label>`;
  }
}

function toggleRozliczenie(forma, typ) {
  const container = document.getElementById("rozliczenieContainer");
  container.innerHTML = "";

  if (typ === "miesiƒôczne") {
    container.innerHTML = `
      <label>Wynagrodzenie miesiƒôczne brutto (PLN)*:<input type="number" name="wynagrodzenie" required></label>`;
    if (forma === "Umowa zlecenie") {
      container.innerHTML += `
        <label>Liczba godzin miesiƒôcznie*:<input type="number" name="godziny_miesiecznie" required></label>`;
    }
  } else if (typ === "godzinowe") {
    container.innerHTML = `
      <label>Stawka za godzinƒô (PLN)*:<input type="number" name="stawka_godzinowa" required></label>
      <label>Liczba godzin miesiƒôcznie*:<input type="number" name="godziny_miesieczne" required></label>`;
  } else if (typ === "inne") {
    container.innerHTML = `
      <label>Opis warunk√≥w rozliczenia*:<textarea name="rozliczenie_inne" required></textarea></label>`;
  }
}

// === Obs≈Çuga kod√≥w pocztowych i numeru telefonu ===
document.addEventListener("input", function (e) {
  if (e.target.id === "kodPocztowy" || e.target.id === "kodPocztowyDomowy") {
    let val = e.target.value.replace(/\D/g, "").slice(0, 5);
    if (val.length >= 3) val = val.slice(0, 2) + "-" + val.slice(2);
    e.target.value = val;
  }

  if (e.target.id === "telefon") {
    let val = e.target.value.replace(/\D/g, "").slice(0, 9);
    if (val.length > 3 && val.length <= 6) {
      val = val.slice(0, 3) + " " + val.slice(3);
    } else if (val.length > 6) {
      val = val.slice(0, 3) + " " + val.slice(3, 6) + " " + val.slice(6);
    }
    e.target.value = val;
  }
});

// === Potwierdzenie i wysy≈Çka ===
function confirmSubmission() {
  const btn = event.target;
  btn.disabled = true;
  btn.innerText = "Tworzenie PDF...";

  const data = window._formDataToSend;
  const summaryHTML = document.getElementById("summaryContent").innerHTML;

  google.script.run.withSuccessHandler(function (response) {
    const { url, blob, name } = response;

    const link = document.createElement("a");
    link.href = "data:application/pdf;base64," + btoa(String.fromCharCode(...new Uint8Array(blob)));
    link.download = name;
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);

    document.getElementById("summaryModal").style.display = "none";
    document.getElementById("driveLink").href = url;
    document.getElementById("successModal").style.display = "block";
    closeSummary();

    document.getElementById("hireForm").reset();
    window.scrollTo({ top: 0, behavior: 'smooth' });


    
  }).submitForm(data);
}
function closeSuccessModal() {
  document.getElementById("successModal").style.display = "none";
}


function showSummary() {

  const form = document.getElementById("hireForm");
  
  if (!form.checkValidity()) {
    form.reportValidity(); // wy≈õwietli domy≈õlne b≈Çƒôdy
    return;
  }

  const data = Object.fromEntries(new FormData(form).entries());
  window._formDataToSend = data;

  let summary = "";
  function addItem(label, value) {
    summary += `<div class="summary-item"><span class="summary-label">${label}:</span> <span class="summary-value">${value || "‚Äî"}</span></div>`;
  }

  summary += `<div class="summary-section">üßç Dane pracownika</div>`;
  addItem("Imiƒô i nazwisko", data.imieNazwisko);
  addItem("PESEL", data.pesel);
  addItem("Adres", `${data.adres_ulica} ${data.adres_nr}, ${data.adres_kod} ${data.adres_miasto}`);
  addItem("Telefon", data.telefon);

  summary += `<div class="summary-section">üìë Szczeg√≥≈Çy wsp√≥≈Çpracy</div>`;
  addItem("Stanowisko", data.stanowisko);
  addItem("Dzia≈Ç", data.dzial + (data.dzial_inne_input ? ` (${data.dzial_inne_input})` : ""));
  addItem("Zakres obowiƒÖzk√≥w", data.zakres);
  addItem("Sp√≥≈Çka zatrudniajƒÖca", data.spolka);
  addItem("Data podpisania umowy", data.dataZatrudnienia);
  addItem("Rodzaj umowy", data.rodzajUmowy);
  addItem("Forma wsp√≥≈Çpracy", data.forma + (data.inna_forma_wspolpracy ? ` (${data.inna_forma_wspolpracy})` : ""));
  addItem("Od", data.od);
  addItem("Do", data.do);
  if (data.wymiar) addItem("Wymiar etatu", data.wymiar);
  if (data.etat_inny_input) addItem("Wymiar etatu", data.etat_inny_input);
  if (data.wynagrodzenie) addItem("Wynagrodzenie miesiƒôczne", data.wynagrodzenie);
  if (data.stawka_godzinowa) addItem("Stawka godzinowa", data.stawka_godzinowa);
  if (data.godziny_miesiecznie) addItem("Liczba godzin miesiƒôcznie", data.godziny_miesiecznie);
  if (data.rozliczenie_inne) addItem("Spos√≥b rozliczenia", data.rozliczenie_inne);
  addItem("Premie", data.premie);

  summary += `<div class="summary-section">üè¢ Organizacja pracy</div>`;
  addItem("Model miejsca pracy", data.model);
  if (data.adres_biuro) addItem("Biuro", data.adres_biuro);
  if (data.adres_domowy_ulica) {
    addItem("Adres domowy", `${data.adres_domowy_ulica} ${data.adres_domowy_nr}, ${data.adres_domowy_kod} ${data.adres_domowy_miasto}`);
  }
  addItem("Prze≈Ço≈ºony", data.przelozony);
  addItem("Opiekun", data.opiekun);
  addItem("Uwagi", data.uwagi);

  document.getElementById("summaryContent").innerHTML = summary;
  document.getElementById("summaryModal").style.display = "block";
}



function closeSummary() {
  document.getElementById("summaryModal").style.display = "none";
}

// === Obs≈Çuga podsumowania ===
document.getElementById("hireForm").addEventListener("submit", function (e) {
  e.preventDefault();
  const pesel = document.getElementById("pesel").value;
  if (!/^\d{11}$/.test(pesel)) {
    alert("PESEL powinien mieƒá dok≈Çadnie 11 cyfr.");
    return;
  }

  const form = this;
  const data = Object.fromEntries(new FormData(form).entries());
  window._formDataToSend = data;

  let summary = "";
  function addItem(label, value) {
    summary += `<div class="summary-item"><span class="summary-label">${label}:</span> <span class="summary-value">${value || "‚Äî"}</span></div>`;
  }

  summary += `<div class="summary-section">üßç Dane pracownika</div>`;
  addItem("Imiƒô i nazwisko", data.imieNazwisko);
  addItem("PESEL", data.pesel);
  addItem("Adres", `${data.adres_ulica} ${data.adres_nr}, ${data.adres_kod} ${data.adres_miasto}`);
  addItem("Telefon", data.telefon);

  summary += `<div class="summary-section">üìë Szczeg√≥≈Çy wsp√≥≈Çpracy</div>`;
  addItem("Stanowisko", data.stanowisko);
  addItem("Dzia≈Ç", data.dzial + (data.dzial_inne_input ? ` (${data.dzial_inne_input})` : ""));
  addItem("Zakres obowiƒÖzk√≥w", data.zakres);
  addItem("Sp√≥≈Çka zatrudniajƒÖca", data.spolka);
  addItem("Data podpisania umowy", data.dataZatrudnienia);
  addItem("Rodzaj umowy", data.rodzajUmowy);
  addItem("Forma wsp√≥≈Çpracy", data.forma + (data.inne_warunki_wspolpracy ? ` (${data.inne_warunki_wspolpracy})` : ""));
  addItem("Od", data.od);
  addItem("Do", data.do);
  if (data.etat) addItem("Wymiar etatu", data.etat);
  if (data.wymiar) addItem("Wymiar etatu", data.wymiar);
  if (data.etat_inny_input) addItem("Wymiar etatu", data.etat_inny_input);
  if (data.wynagrodzenie) addItem("Wynagrodzenie miesiƒôczne", data.wynagrodzenie);
  if (data.stawka_godzinowa) addItem("Stawka godzinowa", data.stawka_godzinowa);
  if (data.godziny_miesiecznie) addItem("Liczba godzin miesiƒôcznie", data.godziny_miesiecznie);
  if (data.rozliczenie_inne) addItem("Spos√≥b rozliczenia", data.rozliczenie_inne);
  addItem("Premie", data.premie);

  summary += `<div class="summary-section">üè¢ Organizacja pracy</div>`;
  addItem("Model miejsca pracy", data.model);
  if (data.adres_biuro) addItem("Biuro", data.adres_biuro);
  if (data.adres_domowy_ulica) {
    addItem("Adres domowy", `${data.adres_domowy_ulica} ${data.adres_domowy_nr}, ${data.adres_domowy_kod} ${data.adres_domowy_miasto}`);
  }
  addItem("Prze≈Ço≈ºony", data.przelozony);
  addItem("Opiekun", data.opiekun);
  addItem("Uwagi", data.uwagi);

  document.getElementById("summaryContent").innerHTML = summary;
  document.getElementById("summaryModal").style.display = "block";
});
</script>
  </body>
</html>
  `;
}



function doGet() {
  return HtmlService.createHtmlOutput(getHtml())
    .setTitle("Zg≈Çoszenie zatrudnienia")
    .setXFrameOptionsMode(HtmlService.XFrameOptionsMode.ALLOWALL);
}


function include(filename) {
  return HtmlService.createHtmlOutputFromFile(filename).getContent();
}

function submitForm(data) {
  const sheet = SpreadsheetApp.openById("1Uzc3sGcpn7yCQkLuVFQHPjo-aBX_Nby9J4zN46avJUE").getSheetByName("Formularze");
  const folder = DriveApp.getFolderById("1I2_v6-H87D2cdfaGS31IUAM_OKpHHgsP");

  const adresZamieszkania = `${data.adres_ulica} ${data.adres_nr}, ${data.adres_kod} ${data.adres_miasto}`;
  const adresDomowy = data.adres_domowy_ulica ? `${data.adres_domowy_ulica} ${data.adres_domowy_nr}, ${data.adres_domowy_kod} ${data.adres_domowy_miasto}` : "-";
  const biuro = data.adres_biuro || "-";
  const dzial = data.dzial || data.dzial_inne_input;
  const forma = data.forma || data.inne_warunki_wspolpracy;
  const wymiar = data.wymiar  ? `${data.wymiar} etatu` : data.etat_inny_input ? `${data.etat_inny_input} etatu`
  : data.godziny_miesieczne  ? `${data.godziny_miesieczne} h`  : "-";
  const rozliczenieTyp = data.b2b_typ || data.zlecenie_typ || data.inne_warunki_wspolpracy || "-";
  const wynagrodzenie = data.wynagrodzenie ? data.wynagrodzenie : data.stawka_godzinowa ? `${data.stawka_godzinowa} z≈Ç/h` : data.rozliczenie_inne ? data.rozliczenie_inne : "-";

  sheet.appendRow([
    new Date(),
    data.imieNazwisko,
    data.pesel,
    adresZamieszkania,
    data.telefon,
    data.stanowisko,
    dzial,
    data.zakres || "-",
    data.spolka,
    data.dataZatrudnienia,
    data.rodzajUmowy,
    forma,
    data.od,
    data.do,
    wymiar,
    rozliczenieTyp,
    wynagrodzenie,
    data.premie || "-",
    data.model,
    biuro || "-",
    adresDomowy || "-",
    data.przelozony,
    data.opiekun  || "-",
    data.uwagi || "-"
  ]);

const doc = DocumentApp.create("Nowe zatrudnienie - " + data.imieNazwisko);
const body = doc.getBody();
body.appendParagraph("Zg≈Çoszenie nowego zatrudnienia").setHeading(DocumentApp.ParagraphHeading.HEADING1)
  .setFontSize(14).setBold(true).setSpacingAfter(12);

  const sekcje = [
    {
      title: "üßç Dane pracownika",
      dane: [
        ["Imiƒô i nazwisko", data.imieNazwisko],
        ["PESEL", data.pesel],
        ["Adres", adresZamieszkania],
        ["Telefon", data.telefon]
      ]
    },
    {
      title: "üìë Szczeg√≥≈Çy wsp√≥≈Çpracy",
      dane: [
        ["Stanowisko", data.stanowisko],
        ["Dzia≈Ç / Pion", dzial],
        ["Zakres obowiƒÖzk√≥w", data.zakres || "-"],
        ["Sp√≥≈Çka zatrudniajƒÖca", data.spolka],
        ["Data podpisania umowy", data.dataZatrudnienia],
        ["Rodzaj umowy", data.rodzajUmowy],
        ["Forma wsp√≥≈Çpracy", forma],
        ["Data rozpoczecia", data.od],
        ["Data zako≈Ñczenia", data.do || "-"],
        ["Wymiar czasu pracy", wymiar],
        ["Wynagrodzenie", wynagrodzenie],
        ["Premie/bonusy", data.premie || "-"]
      ]
    },
    {
      title: "üè¢ Organizacja pracy",
      dane: [
        ["Model miejsca pracy", data.model],
        ["Adres domowy", adresDomowy],
        ["Biuro", biuro],
        ["Prze≈Ço≈ºony", data.przelozony],
        ["Opiekun wdro≈ºeniowy", data.opiekun || "-"],
        ["Uwagi", data.uwagi || "-"]
      ]
    }
  ];

sekcje.forEach(s => {
  body.appendParagraph(s.title)
    .setHeading(DocumentApp.ParagraphHeading.HEADING2)
    .setFontSize(12)
    .setSpacingBefore(10)
    .setSpacingAfter(2);

  const tableData = s.dane.map(([label, val]) => [label, val]);
  const table = body.appendTable(tableData);



  for (let i = 0; i < table.getNumRows(); i++) {
    const row = table.getRow(i);
    row.getCell(0).setBold(true).setBackgroundColor("#f0f8ff").setFontSize(9).setPaddingTop(1).setPaddingBottom(1);
    row.getCell(1).setFontSize(11).setPaddingTop(1).setPaddingBottom(1);
  }
});



  body.appendParagraph("‚úçÔ∏è Podpisy i akceptacje").setHeading(DocumentApp.ParagraphHeading.HEADING2).setFontSize(14).setBold(true).setSpacingAfter(8);
  body.appendParagraph("Data i podpis bezpo≈õredniego prze≈Ço≈ºonego:").setFontSize(10).setSpacingBefore(6).setSpacingAfter(20);
  body.appendParagraph("_____________________________________________").setFontSize(12).setSpacingAfter(6);
  body.appendParagraph("Akceptacja najwy≈ºszego kierownictwa:").setFontSize(10).setSpacingAfter(20);
  body.appendParagraph("_____________________________________________").setFontSize(12);


  doc.saveAndClose();

  const pdf = doc.getAs("application/pdf");
  const file = folder.createFile(pdf);
  file.setName("Nowe zatrudnienie - " + data.imieNazwisko);

  return {
    url: file.getUrl(),
    blob: pdf.getBytes(),
    name: file.getName()
  };
}
